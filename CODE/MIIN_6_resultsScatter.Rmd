---
title: "Meta-analysis of invasive speciesâ€™ impacts on N cycling (MIIN)"
author: "Marissa Lee"
date: "May 20, 2015"
output: pdf_document
---

*Filename: MIIN_4_ESresults.Rmd'*  
```{r setup, include=FALSE}
knitr::opts_chunk$set(cache=TRUE)
library(reshape2)
library(metafor)
library(ggplot2)
library(gridExtra)
library(plyr)
source('rmdCode/mytheme.R')
```

_________________________________________________________________
#PART 1: How do plant traits correlate with invader impacts? 

#A. Make some data choices:
-> use non-unit-standardized soil measures
-> use a standard mean difference (SMD) effect size calculation  
```{r prepdata,echo=FALSE, warning=FALSE, message=FALSE}
dat<-read.table("synthesizedData/clean/forAnalysis.txt", header=TRUE, sep="\t")

## Do some cleaning for the factor analyses ######################################################
dat$CWMDiff_qualRank<-dat$InvArea_qualRank+dat$NatArea_qualRank
dat$InvSpInvArea_qualRank<-factor(dat$InvSpInvArea_qualRank)
dat$NatArea_qualRank<-factor(dat$NatArea_qualRank)
dat$CWMDiff_qualRank<-factor(dat$CWMDiff_qualRank)

unique(dat$ecosystCat)
dat$ecosystCat<-factor(dat$ecosystCat, levels=c("forest","shrubland","grassland","wetland","other"))

unique(dat$studyType)
dat$studyType <- factor(dat$studyType, 
                         levels = c("field study", 
                                    "field expt addition", 
                                    "field expt removal", 
                                    "greenhouse expt"))

unique(dat$InvLeg)
dat$InvLeg <- factor(dat$InvLeg, 
                         levels = c("Non-legume", 
                                    "Legume"))

unique(dat$NatLeg)
dat$NatLeg <- factor(dat$NatLeg, 
                         levels = c("Legumes absent", 
                                    "Legumes present"))

#data structure
summ<-ddply(dat, ~measCat+traitCat, summarize,
                 nRows = length(obsID),
                 uniqueObs = length(unique(obsID)))
#summ

## Set up looping factors and their labels
#MEASCAT
dat1<-subset(dat, measCat %in% c("nh","no", "toti",
                                  "ammonif", "nitrif","nminz",
                                  "soilmoi","som","ph","soiln","soilcn"))
dat1<-transform(dat1, measCat = factor(measCat, levels=c("nh", "no", "toti",
                                                   "ammonif", "nitrif","nminz",
                                                   "soilmoi","som", "ph","soiln","soilcn")))
ylabs <- c("Ammonium", "Nitrate", "Total inorg. N", 
           "Ammonif.","Nitrif.","Minz.",
           "Soil moisture","SOM","pH","Soil N","Soil C:N")
MEASCAT<-levels(dat1$measCat)

#TRAIT
dat1<-transform(dat1, traitCat = factor(traitCat, levels=c("percN", "litterpercN",
                                                           "cn","littercn")))
TRAIT<-levels(dat1$traitCat)
globalxlabs2<-c('leaf %N','litter %N','leaf C:N','litter C:N')

#PLANT
PLANT<-c('InvSpInvArea_cwm', 'NatArea_cwm', 'CWMDiff_cwm')
globalxlabs1<-c('Invasive sp.', 'Native CWM', 'Diff CWM')

## Set up global y axis label
globalylab<-'Standardized mean difference (Inv-Ref)' #SMD

#Functions
source('rmdCode/resultsScatter/fxn_LoopPlots.R')
source('rmdCode/resultsScatter/fxn_SaveFitStats.R')

#source('rmdCode/resultsScatter/fxn_FitPlot1.R')
```

#B. How do plant traits correlate with invader impacts? 
-> Fit rma.mv models and make plots for each trait x effect size comparison  
-> Save everything in named lists.
-> Write results tables.
```{r makeObjs, echo=TRUE, warning=FALSE}
#Plot and run REML base model
INVlist<-FitPlot_1(dat1, k=1)
NATlist<-FitPlot_1(dat1, k=2)
DIFFlist<-FitPlot_1(dat1, k=3)

# INVlist<-FitPlot1(dat1, k=1)
# NATlist<-FitPlot1(dat1, k=2)
# DIFFlist<-FitPlot1(dat1, k=3)

INVtab<-rbind(ldply(INVlist[['results']][['percN']]),
              ldply(INVlist[['results']][['litterpercN']]),
              ldply(INVlist[['results']][['cn']]),
              ldply(INVlist[['results']][['littercn']]))[,-1]
NATtab<-rbind(ldply(NATlist[['results']][['percN']]),
              ldply(NATlist[['results']][['litterpercN']]),
              ldply(NATlist[['results']][['cn']]),
              ldply(NATlist[['results']][['littercn']]))[,-1]
DIFFtab<-rbind(ldply(DIFFlist[['results']][['percN']]),
              ldply(DIFFlist[['results']][['litterpercN']]),
              ldply(DIFFlist[['results']][['cn']]),
              ldply(DIFFlist[['results']][['littercn']]))[,-1]

write.table(INVtab, file='tables/INVtab.txt', sep="\t", row.names=FALSE)
write.table(NATtab, file='tables/NATtab.txt', sep="\t", row.names=FALSE)
write.table(DIFFtab, file='tables/DIFFtab.txt', sep="\t", row.names=FALSE)
```

### Which correlations have a slope that differs from 0?
```{r diff0, echo=FALSE, warning=FALSE}
INVtab[INVtab$pVal <0.1 & INVtab$measType %in% MEASCAT,]
DIFFtab[DIFFtab$pVal <0.1 & DIFFtab$measType %in% MEASCAT,]
NATtab[NATtab$pVal <0.1 & NATtab$measType %in% MEASCAT,]
```
\pagebreak

### Figure 4. Ref and Diff cn X 2 som, soilcn
```{r fig4, echo=FALSE, warning=FALSE}
filename<-"fig4.png"
mypath<-file.path("/Users/mrl17/Documents/duke/wrightlab/projects/MetaInvN_Spring2011/MIIN_repository", "figures", filename)
png(mypath, units='in', width = 5, height = 8, res=300)

# top, right, bottom, and left margins for panels
top<-0
right<-0.05
bottom<-0
left<-0.05

#global y label
ylabel <- textGrob(c('Total inorg. N','Mineralization',
                     'Soil C:N','Soil organic matter',
                  'Std. Mean Difference (Inv-Ref)'), 
                y=c(0.87,0.62,0.38,0.13,
                    0.5),
                x=unit(c(2,2,2,2,
                         1),'lines'), rot=90)

#global x label
xlabel<- textGrob(c('Reference area\nLeaf C:N', 'Invaded - Reference area\nLeaf C:N'), 
               x=c(0.25,0.75),
               y=unit(c(1,1), 'lines'))

#put it together
grid.arrange(
  
  ylabel, # topleft
  
  arrangeGrob(
    
    NATlist[['figures']][['cn']][['toti']] + ggtitle('a') +
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    DIFFlist[['figures']][['cn']][['toti']] + ggtitle('b') +
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    
    NATlist[['figures']][['cn']][['nminz']] + ggtitle('c') +
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    DIFFlist[['figures']][['cn']][['nminz']] + ggtitle('d') +
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    
    NATlist[['figures']][['cn']][['soilcn']] + ggtitle('e') +
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    DIFFlist[['figures']][['cn']][['soilcn']] + ggtitle('f') +
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    
    NATlist[['figures']][['cn']][['som']] + ggtitle('g') +
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    DIFFlist[['figures']][['cn']][['som']] + ggtitle('h') +
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    
    nrow=4, ncol=2),
  
  textGrob(" "), #bottom left
  
  xlabel, #bottom right
  
  widths = unit.c(unit(2.5, "lines"), unit(1, "npc") - unit(2.5, "lines")), 
  heights = unit.c(unit(1, "npc") - unit(2.5, "lines"), unit(2.5, "lines")), 
  nrow=2, ncol=2)

dev.off()
```
![alt text](figures/fig4.png) 

### Figure 5.Invasive sp
```{r fig5a, echo=FALSE, warning=FALSE}
filename<-"fig5.png"
mypath<-file.path("/Users/mrl17/Documents/duke/wrightlab/projects/MetaInvN_Spring2011/MIIN_repository", "figures", filename)
png(mypath, units='in', width = 5, height = 6, res=300)

# top, right, bottom, and left margins for panels
top<-0
right<-0.05
bottom<-0
left<-0.05

#global y label
ylabel <- textGrob(c('Soil N','Soil C:N','Soil organic matter',
                  'Std. Mean Difference (Inv-Ref)'), 
                y=c(0.83,0.5,0.15,
                    0.5),
                x=unit(c(2,2,2,
                         1),'lines'), rot=90)

#global x label
xlabel<- textGrob(c('Invasive sp.\nLeaf %N', 'Invasive sp.\nLitter %N'), 
               x=c(0.25,0.75),
               y=unit(c(1,1), 'lines'))

#put it together
grid.arrange(
  
  ylabel, # topleft
  
  arrangeGrob(
    INVlist[['figures']][['percN']][['soiln']]+ ggtitle('a') + 
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    INVlist[['figures']][['litterpercN']][['soiln']]+ ggtitle('b') + 
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    
    INVlist[['figures']][['percN']][['soilcn']]+ ggtitle('c') + 
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    INVlist[['figures']][['litterpercN']][['soilcn']]+ ggtitle('d') + 
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    
    INVlist[['figures']][['percN']][['som']]+ ggtitle('e') + 
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    INVlist[['figures']][['litterpercN']][['som']]+ ggtitle('f')+ 
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    
    nrow = 3, ncol=2), #top right
  
  textGrob(" "), #bottom left
  
  xlabel, #bottom right
  
  widths = unit.c(unit(2.5, "lines"), unit(1, "npc") - unit(2.5, "lines")), 
  heights = unit.c(unit(1, "npc") - unit(2.5, "lines"), unit(2.5, "lines")), 
  nrow=2, ncol=2)

dev.off()

# #look at outliers
# iqrFac<-1
# INVlist[['figures']][['percN']][['soilmoi']] + ggtitle('a') + theme(plot.margin = unit(c(top,right,bottom,left),"in")) +
#   geom_text(aes(label=ifelse((xval>mean(xval)+iqrFac*IQR(xval)|yi>mean(yi)+iqrFac*IQR(yi)
#                                 |xval<mean(xval)-iqrFac*IQR(xval)|yi<mean(yi)-iqrFac*IQR(yi)),
#                                paste(invGenera,obsID), ""), hjust=1))  
```
![alt text](figures/fig5a.png)  

### Figure 6. CWM Diff
```{r fig5b, echo=FALSE, warning=FALSE}
filename<-"fig6.png"
mypath<-file.path("/Users/mrl17/Documents/duke/wrightlab/projects/MetaInvN_Spring2011/MIIN_repository", "figures", filename)
png(mypath, units='in', width = 5, height = 6, res=300)

# top, right, bottom, and left margins for panels
top<-0
right<-0.05
bottom<-0
left<-0.05

#global y label
ylabel <- textGrob(c('Ammonium','Total inorg. N','Mineralization',
                  'Std. Mean Diff. (Inv-Ref)'), 
                y=c(0.83,0.5,0.15,
                    0.5),
                x=unit(c(2,2,2,
                         1),'lines'), rot=90)

#global x label
xlabel<- textGrob(c('Invaded - Reference area\nLitter %N', 'Invaded - Reference area\nLitter C:N'), 
               x=c(0.25,0.75),
               y=unit(c(1,1), 'lines'))

#put it all together
grid.arrange(
  
  ylabel, # topleft
  
  arrangeGrob(
    
    DIFFlist[['figures']][['litterpercN']][['nh']] + ggtitle('a') + 
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    DIFFlist[['figures']][['littercn']][['nh']] + ggtitle('b') +
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    
    DIFFlist[['figures']][['litterpercN']][['toti']] + ggtitle('c') + 
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    DIFFlist[['figures']][['littercn']][['toti']] + ggtitle('d') +
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    
    DIFFlist[['figures']][['litterpercN']][['nminz']] + ggtitle('e') + 
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    DIFFlist[['figures']][['littercn']][['nminz']] + ggtitle('f') +
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    
    nrow=3, ncol=2),
  
  textGrob(" "), #bottom left
  
  xlabel, #bottom right
  
  widths = unit.c(unit(2.5, "lines"), unit(1, "npc") - unit(2.5, "lines")), 
  heights = unit.c(unit(1, "npc") - unit(2.5, "lines"), unit(2.5, "lines")), 
  nrow=2, ncol=2)

dev.off()
```
![alt text](figures/fig5b.png)  

### Extra: Each plant trait by each ES
```{r extrafig, echo=FALSE, warning=FALSE}
grid.arrange(
  arrangeGrob(
    #soiln
    INVlist[['figures']][['percN']][['soiln']] + ggtitle('a'),                               
    NATlist[['figures']][['percN']][['soiln']] + ggtitle('b'), 
    DIFFlist[['figures']][['percN']][['soiln']] + ggtitle('c'),
    
    #soilcn
    INVlist[['figures']][['percN']][['soilcn']] + ggtitle('d'), 
    NATlist[['figures']][['percN']][['soilcn']] + ggtitle('e'),
    DIFFlist[['figures']][['percN']][['soilcn']] + ggtitle('f'),
    
    #som
    INVlist[['figures']][['percN']][['som']] + ggtitle('g'), 
    NATlist[['figures']][['percN']][['som']] + ggtitle('h'),
    DIFFlist[['figures']][['percN']][['som']] + ggtitle('i'),
    
    #soilmoi
    INVlist[['figures']][['percN']][['soilmoi']] + ggtitle('j'), 
    NATlist[['figures']][['percN']][['soilmoi']] + ggtitle('k'),
    DIFFlist[['figures']][['percN']][['soilmoi']] + ggtitle('l'),
    
    nrow=4, ncol=3),
  
  sub=textGrob(c('',
                 'Invasive sp.', 'Native CWM','Diff CWM',
                 'Leaf %N'), 
               x=c(0.5,
                   0.2,0.5,0.85,
                   0.5),
               y=unit(c(3,
                        2,2,2,
                        1), 'lines')),
  
  left=textGrob(c('',
                  'Soil N','Soil C:N','SOM','Soil Moisture', 
                  'Std. Mean Difference (Inv-Ref)'), 
                y=c(0.5,
                    0.87,0.62,0.38,0.12, 
                    0.5),
                x=unit(c(3,
                         2,2,2,2,
                         1),'lines'), rot=90)
  )

## cn
grid.arrange(
  
  INVlist[['figures']][['cn']][['soiln']] + ggtitle('a'), #soiln
  NATlist[['figures']][['cn']][['soiln']] + ggtitle('b'), 
  DIFFlist[['figures']][['cn']][['soiln']] + ggtitle('c'),
  
  INVlist[['figures']][['cn']][['soilcn']] + ggtitle('d'), #soilcn
  NATlist[['figures']][['cn']][['soilcn']] + ggtitle('e'),
  DIFFlist[['figures']][['cn']][['soilcn']] + ggtitle('f'),
  
  INVlist[['figures']][['cn']][['som']] + ggtitle('g'), #som
  NATlist[['figures']][['cn']][['som']] + ggtitle('h'),
  DIFFlist[['figures']][['cn']][['som']] + ggtitle('i'),
  
  INVlist[['figures']][['cn']][['soilmoi']] + ggtitle('j'), #soilmoi
  NATlist[['figures']][['cn']][['soilmoi']] + ggtitle('k'),
  DIFFlist[['figures']][['cn']][['soilmoi']] + ggtitle('l'),
  
  sub=textGrob(c('',
                 'Invasive sp.', 'Native CWM','Diff CWM',
                 'Leaf C:N'), 
               x=c(0.5,
                   0.2,0.5,0.85,
                   0.5),
               y=unit(c(3,
                        2,2,2,
                        1), 'lines')),
  
  left=textGrob(c('',
                  'Soil N','Soil C:N','SOM','Soil Moisture', 
                  'Std. Mean Difference (Inv-Ref)'), 
                y=c(0.5,
                    0.87,0.62,0.38,0.12, 
                    0.5),
                x=unit(c(3,
                         2,2,2,2,
                         1),'lines'), rot=90),
  
  nrow=4, ncol=3
  )

## litterpercN
grid.arrange(
  INVlist[['figures']][['litterpercN']][['soiln']] + ggtitle('a'), #soiln
  NATlist[['figures']][['litterpercN']][['soiln']] + ggtitle('b'), 
  DIFFlist[['figures']][['litterpercN']][['soiln']] + ggtitle('c'),
  
  INVlist[['figures']][['litterpercN']][['soilcn']] + ggtitle('d'), #soilcn
  NATlist[['figures']][['litterpercN']][['soilcn']] + ggtitle('e'),
  DIFFlist[['figures']][['litterpercN']][['soilcn']] + ggtitle('f'),
  
  INVlist[['figures']][['litterpercN']][['som']] + ggtitle('g'), #som
  NATlist[['figures']][['litterpercN']][['som']] + ggtitle('h'),
  DIFFlist[['figures']][['litterpercN']][['som']] + ggtitle('i'),
  
  INVlist[['figures']][['litterpercN']][['soilmoi']] + ggtitle('j'), #soilmoi
  NATlist[['figures']][['litterpercN']][['soilmoi']] + ggtitle('k'),
  DIFFlist[['figures']][['litterpercN']][['soilmoi']] + ggtitle('l'),
  
  sub=textGrob(c('',
                 'Invasive sp.', 'Native CWM','Diff CWM',
                 'Litter %N'), 
               x=c(0.5,
                   0.2,0.5,0.85,
                   0.5),
               y=unit(c(3,
                        2,2,2,
                        1), 'lines')),
  
  left=textGrob(c('',
                  'Soil N','Soil C:N','SOM','Soil Moisture', 
                  'Std. Mean Difference (Inv-Ref)'), 
                y=c(0.5,
                    0.87,0.62,0.38,0.12, 
                    0.5),
                x=unit(c(3,
                         2,2,2,2,
                         1),'lines'), rot=90),
  
  nrow=4, ncol=3
  )


## littercn
grid.arrange(
  INVlist[['figures']][['littercn']][['soiln']] + ggtitle('a'), #soiln
  NATlist[['figures']][['littercn']][['soiln']] + ggtitle('b'), 
  DIFFlist[['figures']][['littercn']][['soiln']] + ggtitle('c'),
  
  INVlist[['figures']][['littercn']][['soilcn']] + ggtitle('d'), #soilcn
  NATlist[['figures']][['littercn']][['soilcn']] + ggtitle('e'),
  DIFFlist[['figures']][['littercn']][['soilcn']] + ggtitle('f'),
  
  INVlist[['figures']][['littercn']][['som']] + ggtitle('g'), #som
  NATlist[['figures']][['littercn']][['som']] + ggtitle('h'),
  DIFFlist[['figures']][['littercn']][['som']] + ggtitle('i'),
  
  INVlist[['figures']][['littercn']][['soilmoi']] + ggtitle('j'), #soilmoi
  NATlist[['figures']][['littercn']][['soilmoi']] + ggtitle('k'),
  DIFFlist[['figures']][['littercn']][['soilmoi']] + ggtitle('l'),
  
  sub=textGrob(c('',
                 'Invasive sp.', 'Native CWM','Diff CWM',
                 'Litter C:N'), 
               x=c(0.5,
                   0.2,0.5,0.85,
                   0.5),
               y=unit(c(3,
                        2,2,2,
                        1), 'lines')),
  
  left=textGrob(c('',
                  'Soil N','Soil C:N','SOM','Soil Moisture', 
                  'Std. Mean Difference (Inv-Ref)'), 
                y=c(0.5,
                    0.87,0.62,0.38,0.12, 
                    0.5),
                x=unit(c(3,
                         2,2,2,2,
                         1),'lines'), rot=90),
  
  nrow=4, ncol=3
  )

```
\pagebreak


_________________________________________________________________
### Extra: How do initial soil conditions correlate with invader impacts?

#A. Make some data choices:
-> use unit-standardized soil measures
```{r part2_prepdata,echo=FALSE, warning=FALSE, message=FALSE}
#Rename columns to use for Init conditions plots
colnames(dat1)[colnames(dat1) %in% c('n1i', 'm1i_logt', 'sd1i_logt')] <- c('Yn', 'Ym', 'Ysd')#inv
colnames(dat1)[colnames(dat1) %in% c('n2i', 'm2i_logt', 'sd2i_logt')] <- c('Xn', 'Xm', 'Xsd')#ref

#data structure
dat.new<-ddply(dat1, ~obsID+measCat, summarize,
            Yn = unique(Yn),
            Ym = unique(Ym),
            Ysd = unique(Ysd),
            Xn = unique(Xn),
            Xm = unique(Xm),
            Xsd = unique(Xsd),
            paperID = unique(paperID))
colnames(dat.new)
#View(dat2)
```

#B. How do initial soil conditions correlate with invader impacts? 
-> Fit rma.mv models and make plots for each inv x ref soil meas comparison  
-> Save everything in named lists.
-> Write results tables.
```{r part2_makeObjs, echo=TRUE, warning=FALSE}
INITlist<-FitPlot_2(dat.new) #why isn't nitrif running here?
INITtab<-ldply(INITlist[['results']])
INITtab
write.table(INITtab, file='tables/INITtab.txt', sep="\t", row.names=FALSE)
```

### Reference X Invaded area measurement scatter plots
```{r refBYinv_scatterplots, echo=FALSE, warning=FALSE}
filename<-"refBYinv_scatterplots.png"
mypath<-file.path("/Users/mrl17/Documents/duke/wrightlab/projects/MetaInvN_Spring2011/MIIN_repository", "figures", filename)
png(mypath, units='in', width = 7, height = 8, res=300)

# top, right, bottom, and left margins for panels
top<-0
right<-0
bottom<--0.2
left<--0.1

#global y label
ylabel <- textGrob('Invaded-area soil measurement', 
                y=0.5,
                x=unit(2,'lines'), rot=90)

#global x label
xlabel<- textGrob('Native-area soil measurement', 
               x=0.5,
               y=unit(2, 'lines'))

#put it all together
grid.arrange(
  ylabel, # topleft
  
  arrangeGrob(
    
    INITlist[['figures']][['nh']] + 
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    INITlist[['figures']][['no']] + 
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    INITlist[['figures']][['toti']] + 
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    
    INITlist[['figures']][['ammonif']] + 
      theme(plot.margin = unit(c(top,right,bottom,left),"in")) +
      ggtitle('Ammonif., no trans.'),
    
    INITlist[['figures']][['nitrif']] +
      theme(plot.margin = unit(c(top,right,bottom,left),"in"))+
      ggtitle('Nitrif., no trans.'),
    
    INITlist[['figures']][['nminz']] + 
      theme(plot.margin = unit(c(top,right,bottom,left),"in"))+
      ggtitle('Minz., no trans.'),
    
    INITlist[['figures']][['soiln']] + 
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    INITlist[['figures']][['soilcn']] + 
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    INITlist[['figures']][['som']] + 
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    
    INITlist[['figures']][['soilmoi']] + 
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    INITlist[['figures']][['ph']] + 
      theme(plot.margin = unit(c(top,right,bottom,left),"in")),
    
    nrow=4, ncol=3),
  
  textGrob(" "), #bottom left
  
  xlabel, #bottom right
  
  widths = unit.c(unit(2.5, "lines"), unit(1, "npc") - unit(2.5, "lines")), 
  heights = unit.c(unit(1, "npc") - unit(2.5, "lines"), unit(2.5, "lines")), 
  nrow=2, ncol=2)

dev.off()
```
![alt text](figures/refBYinv_scatterplots.png)  


